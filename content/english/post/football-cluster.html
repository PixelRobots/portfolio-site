---
title: "Expenses"
author: "Axel-Cleris Gailloty"
date: "26/05/2019"
output:
  pdf_document: default
  html_document: default
---



<pre class="r"><code># Load the packages 
library(tidyverse)
library(FactoMineR)
library(factoextra)
library(highcharter)
library(ggthemes)
library(lubridate)
library(treemap)</code></pre>
<p>This kernel is under construction :) !</p>
<div id="reading-and-preparing-the-data" class="section level1">
<h1>Reading and preparing the data</h1>
<pre class="r"><code>fifa &lt;- read_csv(&quot;data.csv&quot;)
print(paste(&quot;The dataset contains&quot;, dim(fifa)[1], &quot;observations and&quot;, dim(fifa)[2], &quot;columns&quot;))</code></pre>
<pre><code>## [1] &quot;The dataset contains 18207 observations and 89 columns&quot;</code></pre>
<div id="missing-values" class="section level2">
<h2>Missing values</h2>
<p>With this said let’s check the consistency of the dataset by looking for missing values and understanding what each column stands for.</p>
<pre class="r"><code>theme_set(theme_economist())
map_dbl(fifa, function(x) sum(is.na(x))/length(x)*100) %&gt;%
  stack() %&gt;%
  ggplot(aes(x = reorder(ind,values), y = values)) + 
  geom_bar(stat = &#39;identity&#39;) + coord_flip() +
  labs(y = &quot;% of missing values&quot;, x = &quot;Columns&quot;, title = &quot;Missing values&quot;)</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<p>The loaned from column contains lots of missing values. All the other columns have between 0 and 10% missing values. Overall the dataset contains few missing values.</p>
</div>
<div id="columns-content" class="section level2">
<h2>Columns content</h2>
<pre class="r"><code>head(fifa)</code></pre>
<pre><code>## # A tibble: 6 x 89
##      X1     ID Name    Age Photo Nationality Flag  Overall Potential Club 
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
## 1     0 158023 L. M~    31 http~ Argentina   http~      94        94 FC B~
## 2     1  20801 Cris~    33 http~ Portugal    http~      94        94 Juve~
## 3     2 190871 Neym~    26 http~ Brazil      http~      92        93 Pari~
## 4     3 193080 De G~    27 http~ Spain       http~      91        93 Manc~
## 5     4 192985 K. D~    27 http~ Belgium     http~      91        92 Manc~
## 6     5 183277 E. H~    27 http~ Belgium     http~      91        91 Chel~
## # ... with 79 more variables: `Club Logo` &lt;chr&gt;, Value &lt;chr&gt;, Wage &lt;chr&gt;,
## #   Special &lt;dbl&gt;, `Preferred Foot` &lt;chr&gt;, `International
## #   Reputation` &lt;dbl&gt;, `Weak Foot` &lt;dbl&gt;, `Skill Moves` &lt;dbl&gt;, `Work
## #   Rate` &lt;chr&gt;, `Body Type` &lt;chr&gt;, `Real Face` &lt;chr&gt;, Position &lt;chr&gt;,
## #   `Jersey Number` &lt;dbl&gt;, Joined &lt;chr&gt;, `Loaned From` &lt;chr&gt;, `Contract
## #   Valid Until` &lt;chr&gt;, Height &lt;chr&gt;, Weight &lt;chr&gt;, LS &lt;chr&gt;, ST &lt;chr&gt;,
## #   RS &lt;chr&gt;, LW &lt;chr&gt;, LF &lt;chr&gt;, CF &lt;chr&gt;, RF &lt;chr&gt;, RW &lt;chr&gt;, LAM &lt;chr&gt;,
## #   CAM &lt;chr&gt;, RAM &lt;chr&gt;, LM &lt;chr&gt;, LCM &lt;chr&gt;, CM &lt;chr&gt;, RCM &lt;chr&gt;,
## #   RM &lt;chr&gt;, LWB &lt;chr&gt;, LDM &lt;chr&gt;, CDM &lt;chr&gt;, RDM &lt;chr&gt;, RWB &lt;chr&gt;,
## #   LB &lt;chr&gt;, LCB &lt;chr&gt;, CB &lt;chr&gt;, RCB &lt;chr&gt;, RB &lt;chr&gt;, Crossing &lt;dbl&gt;,
## #   Finishing &lt;dbl&gt;, HeadingAccuracy &lt;dbl&gt;, ShortPassing &lt;dbl&gt;,
## #   Volleys &lt;dbl&gt;, Dribbling &lt;dbl&gt;, Curve &lt;dbl&gt;, FKAccuracy &lt;dbl&gt;,
## #   LongPassing &lt;dbl&gt;, BallControl &lt;dbl&gt;, Acceleration &lt;dbl&gt;,
## #   SprintSpeed &lt;dbl&gt;, Agility &lt;dbl&gt;, Reactions &lt;dbl&gt;, Balance &lt;dbl&gt;,
## #   ShotPower &lt;dbl&gt;, Jumping &lt;dbl&gt;, Stamina &lt;dbl&gt;, Strength &lt;dbl&gt;,
## #   LongShots &lt;dbl&gt;, Aggression &lt;dbl&gt;, Interceptions &lt;dbl&gt;,
## #   Positioning &lt;dbl&gt;, Vision &lt;dbl&gt;, Penalties &lt;dbl&gt;, Composure &lt;dbl&gt;,
## #   Marking &lt;dbl&gt;, StandingTackle &lt;dbl&gt;, SlidingTackle &lt;dbl&gt;,
## #   GKDiving &lt;dbl&gt;, GKHandling &lt;dbl&gt;, GKKicking &lt;dbl&gt;,
## #   GKPositioning &lt;dbl&gt;, GKReflexes &lt;dbl&gt;, `Release Clause` &lt;chr&gt;</code></pre>
<div id="value-and-wage-columns" class="section level3">
<h3>Value and wage columns</h3>
<pre class="r"><code>glimpse(fifa[c(&quot;Value&quot;, &quot;Wage&quot;)])</code></pre>
<pre><code>## Observations: 18,207
## Variables: 2
## $ Value &lt;chr&gt; &quot;€110.5M&quot;, &quot;€77M&quot;, &quot;€118.5M&quot;, &quot;€72M&quot;, &quot;€102M&quot;, &quot;€93M&quot;, &quot;...
## $ Wage  &lt;chr&gt; &quot;€565K&quot;, &quot;€405K&quot;, &quot;€290K&quot;, &quot;€260K&quot;, &quot;€355K&quot;, &quot;€340K&quot;, &quot;€...</code></pre>
<p>Because of their formats <code>€-NUM-M/K</code>, R doesn’t read them properly. We need to do some string manipulations in order to convert them into numerical columns so we can use later in the analysis.<br />
Let’s start by removing the <code>€</code>symbols in both columns.</p>
<pre class="r"><code>fifa &lt;- fifa %&gt;% mutate(Value = str_replace(Value, &quot;€&quot;, &quot;&quot;),
                Wage = str_replace(Wage, &quot;€&quot;, &quot;&quot;))</code></pre>
<p>Now since since the <code>Value</code> column is not always in million € we need to separate each element of it into two columns <code>raw_value</code> and <code>unit</code> that will hold the amount and the unit (millions (M) or thousands(K))</p>
<pre class="r"><code>fifa %&gt;% separate(Value, into = c(&quot;raw_value&quot;, &quot;unit_value&quot;), sep = &quot;(?=[:LETTER:])&quot;) %&gt;%
  select(raw_value, unit_value) %&gt;% group_by(unit_value) %&gt;% summarize(count = n())</code></pre>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 252 rows
## [453, 539, 569, 678, 865, 875, 954, 998, 1009, 1121, 1272, 1353, 1603,
## 1672, 1820, 1903, 1908, 1934, 1937, 1965, ...].</code></pre>
<pre><code>## # A tibble: 3 x 2
##   unit_value count
##   &lt;chr&gt;      &lt;int&gt;
## 1 K          11108
## 2 M           6847
## 3 &lt;NA&gt;         252</code></pre>
<p>As we can see here, there a fewer players who are worth million. Let’s save it and do the same for the Wage column.</p>
<pre class="r"><code>fifa &lt;- fifa %&gt;% separate(Value, into = c(&quot;raw_value&quot;, &quot;unit_value&quot;), sep = &quot;(?=[:LETTER:])&quot;)</code></pre>
<pre class="r"><code>fifa %&gt;% separate(Wage, into = c(&quot;raw_wage&quot;, &quot;unit_wage&quot;), sep = &quot;(?=[:LETTER:])&quot;) %&gt;%
  select(raw_wage, unit_wage) %&gt;% group_by(unit_wage) %&gt;% summarize(count = n())</code></pre>
<pre><code>## # A tibble: 2 x 2
##   unit_wage count
##   &lt;chr&gt;     &lt;int&gt;
## 1 K         17966
## 2 &lt;NA&gt;        241</code></pre>
<p>All the values of this column are expressed in thousands. So we can keep it as it is.</p>
<p>Now let’s convert them into numerical values. We will convert the millions that are in the <code>Value</code> column into thousands(K) so that each observation has the same unit.</p>
<pre class="r"><code># Converting into numerical columns
fifa &lt;- fifa %&gt;% mutate(value_k = as.numeric(raw_value)) 
# Convert it into thousands
fifa &lt;- fifa %&gt;% mutate(value_k = ifelse(unit_value == &quot;M&quot;, value_k * 1000, value_k))
fifa &lt;- fifa %&gt;% mutate(Wage = str_replace(Wage, &quot;K&quot;,&quot;&quot;), Wage = as.numeric(Wage))</code></pre>
</div>
</div>
<div id="date-columns" class="section level2">
<h2>Date columns</h2>
<pre class="r"><code>glimpse(fifa[c(&quot;Joined&quot;, &quot;Contract Valid Until&quot;)])</code></pre>
<pre><code>## Observations: 18,207
## Variables: 2
## $ Joined                 &lt;chr&gt; &quot;Jul 1, 2004&quot;, &quot;Jul 10, 2018&quot;, &quot;Aug 3, ...
## $ `Contract Valid Until` &lt;chr&gt; &quot;2021&quot;, &quot;2022&quot;, &quot;2022&quot;, &quot;2020&quot;, &quot;2023&quot;,...</code></pre>
<pre class="r"><code>fifa &lt;- fifa %&gt;% rename(Contract_Validity = `Contract Valid Until`) %&gt;%
  mutate(Joined = mdy(Joined), 
                Contract_Validity = ymd(Contract_Validity, truncated = 2L))</code></pre>
</div>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1>Exploratory Data Analysis</h1>
<div id="visualizations" class="section level2">
<h2>Visualizations</h2>
<div id="value-distribution" class="section level3">
<h3>Value distribution</h3>
<pre class="r"><code>fifa %&gt;% filter(value_k &lt; 1000) %&gt;%
  ggplot(aes(x = value_k)) + geom_histogram(size = 1.2, fill = &quot;lightblue&quot;, color = &#39;black&#39;) +
  labs(title = &quot;Value distribution of players &lt; million &quot;, x = &quot;Value in K €&quot;)</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>fifa %&gt;% filter(value_k &gt; 1000) %&gt;%
  ggplot(aes(x = value_k)) + geom_histogram(size = 1.2, fill = &quot;lightblue&quot;, color = &#39;black&#39;) +
  labs(title = &quot;Value distribution of players &gt;  1 million&quot;, x = &quot;Value in €&quot;)</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="distribution-of-wage" class="section level2">
<h2>Distribution of wage</h2>
<pre class="r"><code>fifa %&gt;% filter(Wage &lt; 100) %&gt;%
  ggplot(aes(x = Wage)) + geom_histogram(size = 1.2, fill = &quot;lightblue&quot;, color = &#39;black&#39;) + labs(title = &quot;Distribution of wage &lt; 100k €&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>fifa %&gt;% filter(Wage &gt; 100) %&gt;%
  ggplot(aes(x = Wage)) + geom_histogram(size = 1.2, fill = &quot;lightblue&quot;, color = &#39;black&#39;) + labs(title = &quot;Distribution of wage &gt; 100k €&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-16-1.png" width="672" />
### Correlation between wage and value</p>
<pre class="r"><code>fifa %&gt;%
  ggplot(aes(x = value_k, y = Wage)) +
  geom_point(alpha = 1/3) + labs(title = &quot;Correlation between value and wage&quot;, x = &quot;Value (in thousands €)&quot;)</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="time-spent-in-current-club" class="section level2">
<h2>Time spent in current club</h2>
<pre class="r"><code>fifa &lt;- fifa %&gt;% 
  mutate(months_in_current_club = interval(Joined, ymd(2019, truncated = 2L))/months(1))</code></pre>
<div id="link-between-time-spent-in-current-club-and-wage" class="section level3">
<h3>Link between time spent in current club and wage</h3>
<pre class="r"><code>fifa %&gt;%
  ggplot(aes(x = months_in_current_club, y = Wage)) +
  geom_point() + labs(x = &quot;Number of months&quot;, y = &quot;Wage (thousands €)&quot;)</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>There is not obvious relationship between time spent in a club and the wage.</p>
</div>
</div>
<div id="what-are-the-top-nationality-of-the-players" class="section level2">
<h2>What are the top nationality of the players</h2>
<pre class="r"><code>fifa %&gt;% group_by(Nationality) %&gt;%
  summarize(count = n()) %&gt;%
  treemap(index = &quot;Nationality&quot;, vSize = &quot;count&quot;, title = &quot;Nationality of players&quot;)</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>This quite interesting. Out of the Fist five nationalities, 4 are European countries. Football is really popular in Europe in Europe.</p>
</div>
<div id="which-clubs-have-the-highest-spendings-for-their-players" class="section level2">
<h2>Which clubs have the highest spendings for their players</h2>
<pre class="r"><code>fifa %&gt;%
  group_by(Club) %&gt;% summarize(spending = sum(Wage)) %&gt;% top_n(35) %&gt;%
  ggplot(aes(y = spending, x = reorder(Club, spending))) + 
           geom_bar(stat = &quot;identity&quot;) + coord_flip() + 
  labs(y = &quot;Total wages (in thousands €)&quot;, x = &quot;Clubs&quot;, title = &quot;Clubs spendings in wages&quot;)</code></pre>
<pre><code>## Selecting by spending</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
<div id="cluster-analysis" class="section level1">
<h1>Cluster Analysis</h1>
<p>In this section we want to study how can we gather the players based on their characteristics. We will use all the technical columns.</p>
<pre class="r"><code>library(FactoMineR)
library(factoextra)</code></pre>
<p>Since I am not a football professional I’m going to use the columns that mean something in this cluster analysis.
Let’s select the columns</p>
<pre class="r"><code>head(fifa)</code></pre>
<pre><code>## # A tibble: 6 x 92
##      X1     ID Name    Age Photo Nationality Flag  Overall Potential Club 
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
## 1     0 158023 L. M~    31 http~ Argentina   http~      94        94 FC B~
## 2     1  20801 Cris~    33 http~ Portugal    http~      94        94 Juve~
## 3     2 190871 Neym~    26 http~ Brazil      http~      92        93 Pari~
## 4     3 193080 De G~    27 http~ Spain       http~      91        93 Manc~
## 5     4 192985 K. D~    27 http~ Belgium     http~      91        92 Manc~
## 6     5 183277 E. H~    27 http~ Belgium     http~      91        91 Chel~
## # ... with 82 more variables: `Club Logo` &lt;chr&gt;, raw_value &lt;chr&gt;,
## #   unit_value &lt;chr&gt;, Wage &lt;dbl&gt;, Special &lt;dbl&gt;, `Preferred Foot` &lt;chr&gt;,
## #   `International Reputation` &lt;dbl&gt;, `Weak Foot` &lt;dbl&gt;, `Skill
## #   Moves` &lt;dbl&gt;, `Work Rate` &lt;chr&gt;, `Body Type` &lt;chr&gt;, `Real Face` &lt;chr&gt;,
## #   Position &lt;chr&gt;, `Jersey Number` &lt;dbl&gt;, Joined &lt;date&gt;, `Loaned
## #   From` &lt;chr&gt;, Contract_Validity &lt;date&gt;, Height &lt;chr&gt;, Weight &lt;chr&gt;,
## #   LS &lt;chr&gt;, ST &lt;chr&gt;, RS &lt;chr&gt;, LW &lt;chr&gt;, LF &lt;chr&gt;, CF &lt;chr&gt;, RF &lt;chr&gt;,
## #   RW &lt;chr&gt;, LAM &lt;chr&gt;, CAM &lt;chr&gt;, RAM &lt;chr&gt;, LM &lt;chr&gt;, LCM &lt;chr&gt;,
## #   CM &lt;chr&gt;, RCM &lt;chr&gt;, RM &lt;chr&gt;, LWB &lt;chr&gt;, LDM &lt;chr&gt;, CDM &lt;chr&gt;,
## #   RDM &lt;chr&gt;, RWB &lt;chr&gt;, LB &lt;chr&gt;, LCB &lt;chr&gt;, CB &lt;chr&gt;, RCB &lt;chr&gt;,
## #   RB &lt;chr&gt;, Crossing &lt;dbl&gt;, Finishing &lt;dbl&gt;, HeadingAccuracy &lt;dbl&gt;,
## #   ShortPassing &lt;dbl&gt;, Volleys &lt;dbl&gt;, Dribbling &lt;dbl&gt;, Curve &lt;dbl&gt;,
## #   FKAccuracy &lt;dbl&gt;, LongPassing &lt;dbl&gt;, BallControl &lt;dbl&gt;,
## #   Acceleration &lt;dbl&gt;, SprintSpeed &lt;dbl&gt;, Agility &lt;dbl&gt;, Reactions &lt;dbl&gt;,
## #   Balance &lt;dbl&gt;, ShotPower &lt;dbl&gt;, Jumping &lt;dbl&gt;, Stamina &lt;dbl&gt;,
## #   Strength &lt;dbl&gt;, LongShots &lt;dbl&gt;, Aggression &lt;dbl&gt;,
## #   Interceptions &lt;dbl&gt;, Positioning &lt;dbl&gt;, Vision &lt;dbl&gt;, Penalties &lt;dbl&gt;,
## #   Composure &lt;dbl&gt;, Marking &lt;dbl&gt;, StandingTackle &lt;dbl&gt;,
## #   SlidingTackle &lt;dbl&gt;, GKDiving &lt;dbl&gt;, GKHandling &lt;dbl&gt;,
## #   GKKicking &lt;dbl&gt;, GKPositioning &lt;dbl&gt;, GKReflexes &lt;dbl&gt;, `Release
## #   Clause` &lt;chr&gt;, value_k &lt;dbl&gt;, months_in_current_club &lt;dbl&gt;</code></pre>
<pre class="r"><code>pca_data &lt;- fifa[c(3:4,56:89)]</code></pre>
<pre class="r"><code># Remove duplicate players
pca_data &lt;- pca_data %&gt;% filter(!duplicated(Name))</code></pre>
<p>Clean the missing values</p>
<pre class="r"><code>pca_data &lt;- na.omit(pca_data)
pca_data &lt;- data.frame(pca_data, row.names = 1)</code></pre>
<pre class="r"><code>head(pca_data)</code></pre>
<pre><code>##                   Age Crossing Finishing HeadingAccuracy ShortPassing
## L. Messi           31       84        95              70           90
## Cristiano Ronaldo  33       84        94              89           81
## Neymar Jr          26       79        87              62           84
## De Gea             27       17        13              21           50
## K. De Bruyne       27       93        82              55           92
## E. Hazard          27       81        84              61           89
##                   Volleys Dribbling Curve FKAccuracy LongPassing
## L. Messi               86        97    93         94          87
## Cristiano Ronaldo      87        88    81         76          77
## Neymar Jr              84        96    88         87          78
## De Gea                 13        18    21         19          51
## K. De Bruyne           82        86    85         83          91
## E. Hazard              80        95    83         79          83
##                   BallControl Acceleration SprintSpeed Agility Reactions
## L. Messi                   96           91          86      91        95
## Cristiano Ronaldo          94           89          91      87        96
## Neymar Jr                  95           94          90      96        94
## De Gea                     42           57          58      60        90
## K. De Bruyne               91           78          76      79        91
## E. Hazard                  94           94          88      95        90
##                   Balance ShotPower Jumping Stamina Strength LongShots
## L. Messi               95        85      68      72       59        94
## Cristiano Ronaldo      70        95      95      88       79        93
## Neymar Jr              84        80      61      81       49        82
## De Gea                 43        31      67      43       64        12
## K. De Bruyne           77        91      63      90       75        91
## E. Hazard              94        82      56      83       66        80
##                   Aggression Interceptions Positioning Vision Penalties
## L. Messi                  48            22          94     94        75
## Cristiano Ronaldo         63            29          95     82        85
## Neymar Jr                 56            36          89     87        81
## De Gea                    38            30          12     68        40
## K. De Bruyne              76            61          87     94        79
## E. Hazard                 54            41          87     89        86
##                   Composure Marking StandingTackle SlidingTackle GKDiving
## L. Messi                 96      33             28            26        6
## Cristiano Ronaldo        95      28             31            23        7
## Neymar Jr                94      27             24            33        9
## De Gea                   68      15             21            13       90
## K. De Bruyne             88      68             58            51       15
## E. Hazard                91      34             27            22       11
##                   GKHandling GKKicking GKPositioning GKReflexes
## L. Messi                  11        15            14          8
## Cristiano Ronaldo         11        15            14         11
## Neymar Jr                  9        15            15         11
## De Gea                    85        87            88         94
## K. De Bruyne              13         5            10         13
## E. Hazard                 12         6             8          8</code></pre>
<pre class="r"><code>pca &lt;- PCA(pca_data, quanti.sup = 1)</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-28-1.png" width="672" /><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<p>Let’s now try to see how correlated are the variables and discover how they separate the players.</p>
<pre class="r"><code>fviz_pca_var(pca, repel = T) + theme_economist()</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-29-1.png" width="768" /></p>
<pre class="r"><code>dimdesc(pca)</code></pre>
<pre><code>## $Dim.1
## $Dim.1$quanti
##                 correlation       p.value
## BallControl       0.9575674  0.000000e+00
## Dribbling         0.9292212  0.000000e+00
## ShortPassing      0.9163976  0.000000e+00
## Positioning       0.8718798  0.000000e+00
## Crossing          0.8705012  0.000000e+00
## ShotPower         0.8563707  0.000000e+00
## Curve             0.8522071  0.000000e+00
## LongShots         0.8517836  0.000000e+00
## LongPassing       0.8126963  0.000000e+00
## Stamina           0.8073784  0.000000e+00
## Volleys           0.8056571  0.000000e+00
## FKAccuracy        0.7951769  0.000000e+00
## Penalties         0.7871776  0.000000e+00
## Finishing         0.7807105  0.000000e+00
## Agility           0.7243417  0.000000e+00
## HeadingAccuracy   0.7159097  0.000000e+00
## Acceleration      0.7123085  0.000000e+00
## SprintSpeed       0.7041238  0.000000e+00
## Vision            0.7039064  0.000000e+00
## Composure         0.6750123  0.000000e+00
## Aggression        0.6369436  0.000000e+00
## Balance           0.6350150  0.000000e+00
## Marking           0.5407773  0.000000e+00
## StandingTackle    0.5111614  0.000000e+00
## Interceptions     0.5095279  0.000000e+00
## SlidingTackle     0.4793948  0.000000e+00
## Reactions         0.4262738  0.000000e+00
## Jumping           0.2632617 8.458303e-270
## Strength          0.1226311  1.883645e-58
## Age               0.1027927  1.652906e-41
## GKKicking        -0.8483274  0.000000e+00
## GKPositioning    -0.8484342  0.000000e+00
## GKHandling       -0.8517354  0.000000e+00
## GKReflexes       -0.8525332  0.000000e+00
## GKDiving         -0.8533499  0.000000e+00
## 
## 
## $Dim.2
## $Dim.2$quanti
##                 correlation       p.value
## Finishing        0.48869080  0.000000e+00
## Volleys          0.39497273  0.000000e+00
## Agility          0.36161221  0.000000e+00
## Positioning      0.33718933  0.000000e+00
## Vision           0.33672344  0.000000e+00
## Penalties        0.32794746  0.000000e+00
## LongShots        0.32309363  0.000000e+00
## Balance          0.30934699  0.000000e+00
## Acceleration     0.28467696 4.463986e-317
## Curve            0.26913331 2.457159e-282
## SprintSpeed      0.23622994 4.019428e-216
## Dribbling        0.23147968 2.312527e-207
## FKAccuracy       0.22333367 8.455848e-193
## GKKicking        0.18696811 1.054205e-134
## ShotPower        0.18605096 2.212049e-133
## GKHandling       0.18586050 4.153619e-133
## GKDiving         0.18469723 1.919634e-131
## GKReflexes       0.18462331 2.446956e-131
## GKPositioning    0.18245441 2.894091e-128
## Crossing         0.09501422  1.090711e-35
## BallControl      0.08345967  6.815662e-28
## Composure       -0.01643873  3.134159e-02
## Reactions       -0.03010491  8.047868e-05
## ShortPassing    -0.06956196  7.525288e-20
## Age             -0.11049258  1.004341e-47
## LongPassing     -0.14743043  6.184010e-84
## Stamina         -0.22397254 6.395073e-194
## Jumping         -0.25648884 9.891799e-256
## HeadingAccuracy -0.39038523  0.000000e+00
## Strength        -0.51113647  0.000000e+00
## Aggression      -0.57430161  0.000000e+00
## Marking         -0.74305466  0.000000e+00
## Interceptions   -0.77149466  0.000000e+00
## StandingTackle  -0.79446128  0.000000e+00
## SlidingTackle   -0.80109110  0.000000e+00
## 
## 
## $Dim.3
## $Dim.3$quanti
##                correlation       p.value
## Reactions       0.73323051  0.000000e+00
## Age             0.55111367  0.000000e+00
## Composure       0.53883124  0.000000e+00
## GKPositioning   0.41000841  0.000000e+00
## GKHandling      0.40447867  0.000000e+00
## GKReflexes      0.40429174  0.000000e+00
## GKKicking       0.40274211  0.000000e+00
## GKDiving        0.40114161  0.000000e+00
## Strength        0.38320668  0.000000e+00
## Vision          0.37647732  0.000000e+00
## LongPassing     0.24431357 1.735274e-231
## FKAccuracy      0.20506235 3.258515e-162
## LongShots       0.17944771 4.544011e-124
## ShotPower       0.17399244 1.206321e-116
## Aggression      0.17287201 3.768740e-115
## Curve           0.15234669  1.456918e-89
## ShortPassing    0.14868943  2.335257e-85
## Volleys         0.14289355  6.527233e-79
## Interceptions   0.11498692  1.455053e-51
## Jumping         0.09745726  1.818163e-37
## Penalties       0.08770203  1.226461e-30
## Finishing       0.06213573  3.817631e-16
## BallControl     0.04354398  1.166468e-08
## Crossing        0.04175925  4.486744e-08
## Positioning     0.03431513  6.966596e-06
## Marking         0.02828461  2.118418e-04
## StandingTackle  0.02147269  4.922562e-03
## Stamina        -0.02418791  1.536283e-03
## Dribbling      -0.03738368  9.735851e-07
## Agility        -0.14372548  8.049441e-80
## Balance        -0.26358489 1.759919e-270
## SprintSpeed    -0.29679997  0.000000e+00
## Acceleration   -0.30572583  0.000000e+00</code></pre>
<pre class="r"><code>fviz_pca_contrib(pca, choice = &quot;var&quot;)</code></pre>
<pre><code>## Warning in fviz_pca_contrib(pca, choice = &quot;var&quot;): The function
## fviz_pca_contrib() is deprecated. Please use the function fviz_contrib()
## which can handle outputs of PCA, CA and MCA functions.</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre class="r"><code>fviz_pca_contrib(pca, choice = &quot;var&quot;, axes = 2)</code></pre>
<pre><code>## Warning in fviz_pca_contrib(pca, choice = &quot;var&quot;, axes = 2): The function
## fviz_pca_contrib() is deprecated. Please use the function fviz_contrib()
## which can handle outputs of PCA, CA and MCA functions.</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<pre class="r"><code>fviz_pca_ind(pca, geom = &quot;point&quot;, alpha.ind = &quot;contrib&quot;, addEllipses = T) + theme_economist()</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<pre class="r"><code>fviz_pca_ind(pca, geom = &quot;point&quot;, 
             alpha.ind = &quot;contrib&quot;, addEllipses = T) + theme_economist() +
  xlim(c(-6, -10))</code></pre>
<pre><code>## Warning: Removed 16778 rows containing non-finite values (stat_ellipse).</code></pre>
<pre><code>## Warning: Removed 16778 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_vline).</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<pre class="r"><code>fviz_pca_ind(pca, geom = &quot;text&quot;, 
             select.ind = list(name = c(&quot;L. Messi&quot;, 
                                        &quot;Cristiano Ronaldo&quot;, &quot;Neymar Jr&quot;, &quot;E. Hazard&quot;))) + 
  theme_economist()</code></pre>
<p><img src="/english/post/football-cluster_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
