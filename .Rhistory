blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
getwd()
getwd()
getwd()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
?blogdown::html_page
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
```{r, message=FALSE, warning = FALSE}
# Load the packages
library(tidyverse)
# Load the packages
library(tidyverse)
library(FactoMineR)
library(FactoMineR)
library(factoextra)
library(highcharter)
library(ggthemes)
library(lubridate)
library(treemap)
# Load the packages
library(tidyverse)
library(FactoMineR)
library(factoextra)
library(highcharter)
library(ggthemes)
library(lubridate)
library(treemap)
---
title: Football clubs expenses
author: Axel-Cleris Gailloty
date: '2019-05-22'
slug: football-clubs-expenses
categories:
- R
tags:
- R
- visualizations
- analysis
image:
caption: ''
focal_point: ''
---
```{r, message=FALSE, warning = FALSE}
# Load the packages
library(tidyverse)
library(FactoMineR)
library(factoextra)
library(highcharter)
library(ggthemes)
library(lubridate)
library(treemap)
```
This kernel is under construction :) !
# Reading and preparing the data
```{r, message=FALSE, warning=FALSE}
fifa <- read_csv("data.csv")
fifa <- read_csv("data.csv")
print(paste("The dataset contains", dim(fifa)[1], "observations and", dim(fifa)[2], "columns"))
fifa <- read_csv("data.csv")
print(paste("The dataset contains", dim(fifa)[1], "observations and", dim(fifa)[2], "columns"))
## Missing values
map_dbl(fifa, function(x) sum(is.na(x))/length(x)*100) %>%
stack() %>%
ggplot(aes(x = reorder(ind,values), y = values)) +
geom_bar(stat = 'identity') + coord_flip() +
labs(y = "% of missing values", x = "Columns", title = "Missing values")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
install.packages('blogdown')
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
install.packages("blogdown")
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
# Load the packages
library(tidyverse)
# Load the packages
library(tidyverse)
library(FactoMineR)
library(factoextra)
library(highcharter)
library(ggthemes)
library(lubridate)
library(factoextra)
library(highcharter)
library(ggthemes)
library(lubridate)
library(treemap)
# Load the packages
library(tidyverse)
library(FactoMineR)
library(factoextra)
library(highcharter)
library(ggthemes)
library(lubridate)
library(treemap)
print(paste("The dataset contains", dim(fifa)[1], "observations and", dim(fifa)[2], "columns"))
fifa <- read_csv("data.csv")
fifa <- read_csv("data.csv")
print(paste("The dataset contains", dim(fifa)[1], "observations and", dim(fifa)[2], "columns"))
map_dbl(fifa, function(x) sum(is.na(x))/length(x)*100) %>%
stack() %>%
ggplot(aes(x = reorder(ind,values), y = values)) +
geom_bar(stat = 'identity') + coord_flip() +
labs(y = "% of missing values", x = "Columns", title = "Missing values")
theme_set(theme_solarized_2())
map_dbl(fifa, function(x) sum(is.na(x))/length(x)*100) %>%
stack() %>%
ggplot(aes(x = reorder(ind,values), y = values)) +
geom_bar(stat = 'identity') + coord_flip() +
labs(y = "% of missing values", x = "Columns", title = "Missing values")
theme_set(theme_classic())
map_dbl(fifa, function(x) sum(is.na(x))/length(x)*100) %>%
stack() %>%
ggplot(aes(x = reorder(ind,values), y = values)) +
geom_bar(stat = 'identity') + coord_flip() +
labs(y = "% of missing values", x = "Columns", title = "Missing values")
theme_set(theme_fivethirtyeight())
map_dbl(fifa, function(x) sum(is.na(x))/length(x)*100) %>%
stack() %>%
ggplot(aes(x = reorder(ind,values), y = values)) +
geom_bar(stat = 'identity') + coord_flip() +
labs(y = "% of missing values", x = "Columns", title = "Missing values")
theme_set(theme_hc())
theme_set(theme_hc())
theme_set(theme_map())
map_dbl(fifa, function(x) sum(is.na(x))/length(x)*100) %>%
stack() %>%
ggplot(aes(x = reorder(ind,values), y = values)) +
geom_bar(stat = 'identity') + coord_flip() +
labs(y = "% of missing values", x = "Columns", title = "Missing values")
theme_set(theme_economist())
map_dbl(fifa, function(x) sum(is.na(x))/length(x)*100) %>%
stack() %>%
ggplot(aes(x = reorder(ind,values), y = values)) +
geom_bar(stat = 'identity') + coord_flip() +
labs(y = "% of missing values", x = "Columns", title = "Missing values")
head(fifa)
glimpse(fifa[c("Value", "Wage")])
fifa <- fifa %>% mutate(Value = str_replace(Value, "€", ""),
Wage = str_replace(Wage, "€", ""))
fifa %>% separate(Value, into = c("raw_value", "unit_value"), sep = "(?=[:LETTER:])") %>%
select(raw_value, unit_value) %>% group_by(unit_value) %>% summarize(count = n())
fifa <- fifa %>% separate(Value, into = c("raw_value", "unit_value"), sep = "(?=[:LETTER:])")
fifa %>% separate(Wage, into = c("raw_wage", "unit_wage"), sep = "(?=[:LETTER:])") %>%
select(raw_wage, unit_wage) %>% group_by(unit_wage) %>% summarize(count = n())
# Converting into numerical columns
fifa <- fifa %>% mutate(value_k = as.numeric(raw_value))
# Convert it into thousands
fifa <- fifa %>% mutate(value_k = ifelse(unit_value == "M", value_k * 1000, value_k))
fifa <- fifa %>% mutate(Wage = str_replace(Wage, "K",""), Wage = as.numeric(Wage))
# Converting into numerical columns
fifa <- fifa %>% mutate(value_k = as.numeric(raw_value))
# Convert it into thousands
fifa <- fifa %>% mutate(value_k = ifelse(unit_value == "M", value_k * 1000, value_k))
fifa <- fifa %>% mutate(Wage = str_replace(Wage, "K",""), Wage = as.numeric(Wage))
glimpse(fifa[c("Joined", "Contract Valid Until")])
fifa <- fifa %>% rename(Contract_Validity = `Contract Valid Until`) %>%
mutate(Joined = mdy(Joined),
Contract_Validity = ymd(Contract_Validity, truncated = 2L))
fifa %>% filter(value_k < 1000) %>%
ggplot(aes(x = value_k)) + geom_histogram(size = 1.2, fill = "lightblue", color = 'black') +
labs(title = "Value distribution of players < million ", x = "Value in €")
fifa %>% filter(value_k < 1000) %>%
ggplot(aes(x = value_k)) + geom_histogram(size = 1.2, fill = "lightblue", color = 'black') +
labs(title = "Value distribution of players < million ", x = "Value in K €")
fifa %>% filter(value_k > 1000) %>%
ggplot(aes(x = value_k)) + geom_histogram(size = 1.2, fill = "lightblue", color = 'black') +
labs(title = "Value distribution of players >  1 million", x = "Value in €")
fifa %>%
ggplot(aes(x = Wage)) + geom_histogram() + labs(title = "Distribution of wage")
fifa %>% filter(Wage > 1000) %>%
ggplot(aes(x = Wage)) + geom_histogram() + labs(title = "Distribution of wage")
fifa %>% filter(Wage > 100) %>%
ggplot(aes(x = Wage)) + geom_histogram() + labs(title = "Distribution of wage")
fifa %>% filter(Wage > 100) %>%
ggplot(aes(x = Wage)) + geom_histogram(size = 1.2, fill = "lightblue", color = 'black') + labs(title = "Distribution of wage")
fifa %>% filter(Wage < 100) %>%
ggplot(aes(x = Wage)) + geom_histogram(size = 1.2, fill = "lightblue", color = 'black') + labs(title = "Distribution of wage")
fifa %>% filter(Wage < 100) %>%
ggplot(aes(x = Wage)) + geom_histogram(size = 1.2, fill = "lightblue", color = 'black') + labs(title = "Distribution of wage < 100k €")
fifa %>% filter(Wage > 100) %>%
ggplot(aes(x = Wage)) + geom_histogram(size = 1.2, fill = "lightblue", color = 'black') + labs(title = "Distribution of wage > 100k €")
fifa %>%
ggplot(aes(x = value_k, y = Wage)) +
geom_point(alpha = 1/3) + labs(title = "Correlation between value and wage", x = "Value (in thousands €)")
fifa <- fifa %>%
mutate(months_in_current_club = interval(Joined, ymd(2019, truncated = 2L))/months(1))
fifa %>%
ggplot(aes(x = months_in_current_club, y = Wage)) +
geom_point() + labs(x = "Number of months", y = "Wage (thousands €)")
fifa %>% group_by(Nationality) %>%
summarize(count = n()) %>%
treemap(index = "Nationality", vSize = "count", title = "Nationality of players")
fifa %>%
group_by(Club) %>% summarize(spending = sum(Wage)) %>% top_n(30) %>%
ggplot(aes(y = spending, x = reorder(Club, spending))) +
geom_bar(stat = "identity") + coord_flip() +
labs(y = "Total wages (in thousands €)", x = "Clubs", title = "Clubs spendings in wages")
fifa %>%
group_by(Club) %>% summarize(spending = sum(Wage)) %>% top_n(35) %>%
ggplot(aes(y = spending, x = reorder(Club, spending))) +
geom_bar(stat = "identity") + coord_flip() +
labs(y = "Total wages (in thousands €)", x = "Clubs", title = "Clubs spendings in wages")
library(FactoMineR)
library(factoextra)
sum(is.na(fifa))
head(fifa)
pca_data <- fifa[c(2:3,56:89)]
sum(is.na(pca_data))
pca_data %>% group_by(Name) %>%
summarize(nb = n()) %>% top_n(10)
pca_data %>% group_by(Name) %>%
summarize(nb = n()) %>% arrange(nb)
pca_data %>% group_by(Name) %>%
summarize(nb = n()) %>% arrange(desc(nb))
# Remove duplicate players
pca_data2 <- filter(!duplicated(Name))
# Remove duplicate players
pca_data2 <- pca_data %>% filter(!duplicated(Name))
sum(is.na(pca_data2))
map_dbl(pca_data2, function(x) sum(is.na(x)))
pca_data <- na.omit(pca_data2)
pca_data <- data.frame(pca_data, row.names = 1)
pca <- PCA(pca_data, quanti.sup = 2)
head(pca_data)
pca_data <- fifa[c(3:4,56:89)]
# Remove duplicate players
pca_data <- pca_data %>% filter(!duplicated(Name))
pca_data <- na.omit(pca_data2)
pca_data <- data.frame(pca_data, row.names = 1)
head(pca_data)
pca_data <- fifa[c(3:4,56:89)]
# Remove duplicate players
pca_data <- pca_data %>% filter(!duplicated(Name))
pca_data <- na.omit(pca_data)
pca_data <- data.frame(pca_data, row.names = 1)
head(pca_data)
pca <- PCA(pca_data, quanti.sup = 1)
fviz_pca_biplot(pca)
fviz_pca_var(pca)
fviz_pca_var(pca) + theme_economist()
fviz_pca_var(pca, repel = T) + theme_economist()
fviz_pca_ind(pca)
fviz_pca_ind(pca, repel = T)
fviz_pca_var(pca, repel = T) + theme_economist()
cluster <- HCPC(pca, nb.clust = 5)
cluster <- HCPC(pca, nb.clust = 4)
dimdesc(pca)
fviz_pca_contrib(pca)
?fviz_pca_contrib
fviz_pca_contrib(pca, choice = "var")
fviz_pca_contrib(pca, choice = "col")
fviz_pca_contrib(pca, choice = "ind")
fviz_pca_contrib(pca, choice = "var", axes = 2)
fviz_pca_ind(pca, select.ind = c("C. Ronaldo"))
fviz_pca_ind(pca)
fviz_pca_ind(pca, geom = "point")
fviz_pca_ind(pca, geom = "point", alpha.ind = 1/5)
fviz_pca_ind(pca, geom = "point", alpha.ind = 1/5) + theme_economist()
fviz_pca_ind(pca, geom = "point", alpha.ind = 1/5, col.ind = "lightblue") + theme_economist()
fviz_pca_ind(pca, geom = "point", alpha.ind = 1/5, col.ind = "blue") + theme_economist()
fviz_pca_ind(pca, geom = "point", alpha.ind = "contrib", addEllipses = T) + theme_economist()
head(pca_data)
fviz_pca_ind(pca, geom = "point",
alpha.ind = "contrib", addEllipses = T) + theme_economist() +
xlim(c(-6, -10))
alpha.ind = "contrib", addEllipses = T) + theme_economist()
fviz_pca_ind(pca, geom = "point", select.ind = list(Name = c("L. Messi", "C. Ronaldo")),
alpha.ind = "contrib", addEllipses = T) + theme_economist()
fviz_pca_ind(pca, geom = "point", select.ind = list(name = c("L. Messi", "C. Ronaldo")),
alpha.ind = "contrib", addEllipses = T) + theme_economist()
fviz_pca_ind(pca, geom = "text", select.ind = list(name = c("L. Messi", "Cristiano Ronaldo")),
alpha.ind = "contrib", addEllipses = T) + theme_economist()
fviz_pca_ind(pca, geom = "text",
select.ind = list(name = c("L. Messi",
"Cristiano Ronaldo", "Neymar Jr", "E. Hazard"))) +
theme_economist()
blogdown::build_dir()
bookdown:::serve_book()
blogdown::serve_site()
